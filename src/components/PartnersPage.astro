---
import MainLayout from "../layouts/MainLayout.astro";
import { LogoCarousel } from "./LogoCarousel.jsx";
import partners from "../data/partners.json";
import type { PartnersLocaleContent, PartnersSectionKey } from "../data/partners.i18n";
import { marked } from "marked";

export interface Props {
  lang: 'en' | 'es' | 'fr';
  t: PartnersLocaleContent;
}

const { t } = Astro.props as Props;

function hasList(key: PartnersSectionKey): boolean {
  const list = (partners as any)[key];
  return Array.isArray(list) && list.length > 0;
}
---
<MainLayout title={t.metaTitle}>
  <div
    transition:name="partners-card"
    class="m-4 md:m-8 lg:m-12 p-6 md:p-8 lg:p-10 bg-white rounded-xl max-w-6xl w-full mx-auto text-gray-800 font-sans"
  >
    <div class="text-center">
      <h1 class="font-display font-extrabold text-4xl md:text-5xl lg:text-6xl text-gray-900">
        {t.heroTitle}
      </h1>
      <p class="mt-4 max-w-3xl mx-auto text-center text-lg text-gray-500" set:html={marked.parse(t.heroSubtitleMd)} />
    </div>

    <div class="mt-12 md:mt-16 space-y-12">
      {t.sections.map((section) => (
        hasList(section.key) && (
          <div>
            <h2 class="font-display font-bold text-2xl md:text-3xl text-center text-gray-500 tracking-wider uppercase">
              {section.heading}
            </h2>
            <div class="mt-8">
              <LogoCarousel client:visible partners={(partners as any)[section.key]} />
            </div>
          </div>
        )
      ))}
    </div>

    {(t.showDividerBeforeCta ?? false) && <hr class="my-12 md:my-16 border-gray-200 w-48 mx-auto" />}

    <div class="bg-gray-100 rounded-xl p-8 md:p-12 text-center">
      <h2 class="font-display font-bold text-3xl md:text-4xl text-gray-900">
        {t.cta.heading}
      </h2>
      <p class="mt-4 max-w-2xl mx-auto text-lg text-gray-600" set:html={marked.parse(t.cta.bodyMd)} />
      <div class="mt-8">
        <a
          id="sponsor-download"
          href={t.cta.buttonHref}
          class="inline-block px-10 py-4 bg-brand-blue hover:bg-blue-700 text-white font-bold text-lg rounded-full transition-transform transform hover:scale-105"
        >
          {t.cta.buttonLabel}
        </a>
      </div>
    </div>
  </div>
</MainLayout>
